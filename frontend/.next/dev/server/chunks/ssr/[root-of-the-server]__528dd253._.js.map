{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///home/hackos/html/EduStream/frontend/app/components/ChatWidget.tsx"],"sourcesContent":["\"use client\";\nimport { useState, useRef, useEffect } from \"react\";\nimport axios from \"axios\";\n\ninterface Message {\n    role: \"user\" | \"bot\";\n    text: string;\n}\n\nexport default function ChatWidget() {\n    const [isOpen, setIsOpen] = useState(false);\n    const [messages, setMessages] = useState<Message[]>([\n        { role: \"bot\", text: \"Hello! üëã I am your AI Tutor. Select a subject and ask me anything!\" }\n    ]);\n    const [input, setInput] = useState(\"\");\n    const [subject, setSubject] = useState(\"Python\"); // Default Subject\n    const [loading, setLoading] = useState(false);\n\n    // Auto-scroll to bottom\n    const messagesEndRef = useRef<HTMLDivElement>(null);\n    const scrollToBottom = () => {\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n    };\n    useEffect(scrollToBottom, [messages]);\n\n    const sendMessage = async () => {\n        if (!input.trim()) return;\n\n        const userMsg = input;\n        setMessages((prev) => [...prev, { role: \"user\", text: userMsg }]);\n        setInput(\"\");\n        setLoading(true);\n\n        try {\n            // 1. Direct URL use karein (Environment variable issue hatane ke liye)\n            const res = await axios.post(\"http://127.0.0.1:8000/ask-tutor\", {\n                subject: subject,\n                question: userMsg\n            });\n\n            console.log(\"Backend Response:\", res.data); // Console mein check karein\n\n            // 2. Agar Backend ne Error bheja hai\n            if (res.data.error) {\n                setMessages((prev) => [...prev, { role: \"bot\", text: `‚ùå API Error: ${res.data.error} (Hint: ${res.data.hint})` }]);\n            }\n            // 3. Agar Sahi jawab aaya hai\n            else if (res.data.answer) {\n                setMessages((prev) => [...prev, { role: \"bot\", text: res.data.answer }]);\n            }\n            // 4. Agar khali response aaya\n            else {\n                setMessages((prev) => [...prev, { role: \"bot\", text: \"‚ö†Ô∏è Server sent empty response.\" }]);\n            }\n\n        } catch (error: any) {\n            console.error(\"Connection Error:\", error);\n            setMessages((prev) => [...prev, { role: \"bot\", text: \"üö´ Connection Failed! Check if Backend is running.\" }]);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"fixed bottom-5 right-5 z-50 flex flex-col items-end\">\n\n            {/* Chat Box (Hidden/Visible logic) */}\n            {isOpen && (\n                <div className=\"bg-white w-80 h-96 rounded-lg shadow-2xl border border-gray-200 flex flex-col mb-4 overflow-hidden\">\n\n                    {/* Header */}\n                    <div className=\"bg-blue-600 text-white p-3 flex justify-between items-center\">\n                        <h3 className=\"font-bold\">ü§ñ AI Tutor</h3>\n                        <button onClick={() => setIsOpen(false)} className=\"text-white hover:text-gray-200\">‚úï</button>\n                    </div>\n\n                    {/* Subject Selector */}\n                    <div className=\"bg-gray-100 p-2 border-b\">\n                        <select\n                            value={subject}\n                            onChange={(e) => setSubject(e.target.value)}\n                            className=\"w-full p-1 rounded border text-sm text-gray-700\"\n                        >\n                            <option value=\"Python\">Python Programming</option>\n                            <option value=\"Physics\">Physics</option>\n                            <option value=\"Math\">Mathematics</option>\n                            <option value=\"General\">General Doubts</option>\n                        </select>\n                    </div>\n\n                    {/* Messages Area */}\n                    <div className=\"flex-1 p-3 overflow-y-auto bg-gray-50\">\n                        {messages.map((msg, idx) => (\n                            <div key={idx} className={`mb-2 flex ${msg.role === \"user\" ? \"justify-end\" : \"justify-start\"}`}>\n                                <div className={`max-w-[80%] p-2 rounded-lg text-sm ${msg.role === \"user\"\n                                        ? \"bg-blue-500 text-white rounded-br-none\"\n                                        : \"bg-white border text-gray-800 rounded-bl-none shadow-sm\"\n                                    }`}>\n                                    {msg.text}\n                                </div>\n                            </div>\n                        ))}\n                        {loading && <div className=\"text-xs text-gray-400 ml-2\">Thinking... ü§î</div>}\n                        <div ref={messagesEndRef} />\n                    </div>\n\n                    {/* Input Area */}\n                    <div className=\"p-2 border-t bg-white flex gap-2\">\n                        <input\n                            type=\"text\"\n                            className=\"flex-1 border rounded px-2 py-1 text-sm focus:outline-none focus:border-blue-500 text-black\"\n                            placeholder=\"Ask a doubt...\"\n                            value={input}\n                            onChange={(e) => setInput(e.target.value)}\n                            onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\n                        />\n                        <button\n                            onClick={sendMessage}\n                            disabled={loading}\n                            className=\"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 disabled:bg-gray-400\"\n                        >\n                            Send\n                        </button>\n                    </div>\n                </div>\n            )}\n\n            {/* Toggle Button (Hamesha dikhega) */}\n            <button\n                onClick={() => setIsOpen(!isOpen)}\n                className=\"bg-blue-600 text-white p-4 rounded-full shadow-lg hover:bg-blue-700 transition-all transform hover:scale-110 flex items-center justify-center\"\n            >\n                {isOpen ? \"‚¨áÔ∏è\" : \"üí¨ AI Help\"}\n            </button>\n        </div>\n    );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 380, "column": 0}, "map": {"version":3,"sources":["file:///home/hackos/html/EduStream/frontend/app/live/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\nimport { useRouter } from \"next/navigation\";\nimport { JitsiMeeting } from \"@jitsi/react-sdk\";\nimport ChatWidget from \"../components/ChatWidget\";\nimport { jwtDecode } from \"jwt-decode\"; \n\ninterface LiveClass {\n  id: number;\n  title: string;\n  stream_link: string;\n}\n\ninterface DecodedToken {\n  sub: string;\n}\n\nexport default function LiveClassPage() {\n  const [liveClass, setLiveClass] = useState<LiveClass | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [accessDenied, setAccessDenied] = useState(false);\n  const [userEmail, setUserEmail] = useState(\"student@example.com\"); // Variable rename kiya clarity ke liye\n  \n  const router = useRouter();\n  const token = Cookies.get(\"token\");\n\n  useEffect(() => {\n    if (!token) { \n      router.push(\"/login\"); \n      return; \n    }\n\n    try {\n      const decoded: DecodedToken = jwtDecode(token);\n      // Backend mein \"sub\" = email hai\n      setUserEmail(decoded.sub || \"student@example.com\");\n    } catch (e) {\n      console.error(\"Token decode error\", e);\n    }\n\n    fetchLiveClass();\n  }, []);\n\n  const fetchLiveClass = async () => {\n    try {\n      const res = await axios.get<LiveClass[]>(\n        `${process.env.NEXT_PUBLIC_API_URL}/live-classes/`, \n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n      if (res.data.length > 0) {\n        setLiveClass(res.data[0]);\n      }\n    } catch (error: any) {\n      if (error.response && error.response.status === 403) {\n        setAccessDenied(true);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (loading) return <div className=\"h-screen flex items-center justify-center text-xl bg-gray-900 text-white\">Connecting to Classroom... üì°</div>;\n\n  return (\n    <div className=\"h-screen bg-gray-900 text-white flex flex-col\">\n      \n      {/* Header */}\n      <div className=\"bg-gray-800 p-3 flex justify-between items-center shadow-md z-10\">\n        <h1 className=\"text-lg font-bold text-blue-400 flex items-center gap-2\">\n           {liveClass ? (\n             <>\n               <span className=\"animate-pulse w-3 h-3 bg-red-500 rounded-full\"></span>\n               LIVE: {liveClass.title}\n             </>\n           ) : \"EduStream Classroom\"}\n        </h1>\n        <button onClick={() => router.push('/dashboard')} className=\"bg-red-600 hover:bg-red-700 px-4 py-1 rounded text-sm transition\">\n          Exit Class\n        </button>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"flex-1 relative\">\n        \n        {accessDenied ? (\n          // üîí LOCKED SCREEN\n          <div className=\"flex h-full items-center justify-center\">\n            <div className=\"bg-gray-800 p-10 rounded-xl text-center shadow-2xl border border-gray-700\">\n              <div className=\"text-5xl mb-4\">üîí</div>\n              <h2 className=\"text-2xl font-bold mb-2\">Premium Only</h2>\n              <p className=\"text-gray-400 mb-6\">Upgrade to join this live session.</p>\n              <button \n                onClick={() => router.push('/dashboard')}\n                className=\"bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-2 px-6 rounded-full transition transform hover:scale-105\"\n              >\n                Buy Subscription\n              </button>\n            </div>\n          </div>\n        ) : liveClass ? (\n          // üé• JITSI MEETING\n          <JitsiMeeting\n            domain=\"meet.jit.si\"\n            roomName={liveClass.stream_link} \n            configOverwrite={{\n              startWithAudioMuted: true,\n              disableThirdPartyRequests: true,\n              prejoinPageEnabled: false, \n            }}\n            interfaceConfigOverwrite={{\n              TOOLBAR_BUTTONS: [\n                'microphone', 'camera', 'closedcaptions', 'desktop', 'fullscreen',\n                'fodeviceselection', 'hangup', 'profile', 'chat', 'recording',\n                'livestreaming', 'etherpad', 'sharedvideo', 'settings', 'raisehand',\n                'videoquality', 'filmstrip', 'feedback', 'stats', 'shortcuts',\n                'tileview', 'videobackgroundblur', 'download', 'help', 'mute-everyone'\n              ],\n            }}\n            // üëá YAHAN FIX KIYA HAI üëá\n            userInfo={{\n              displayName: userEmail.split('@')[0], // Email ka pehla hissa naam banayenge (e.g., student1)\n              email: userEmail // Jitsi ko email chahiye tha, wo yahan de diya\n            }}\n            getIFrameRef={(iframeRef) => {\n              iframeRef.style.height = \"100%\";\n            }}\n          />\n        ) : (\n          <div className=\"flex flex-col h-full items-center justify-center text-gray-400\">\n            <div className=\"text-6xl mb-4\">‚òï</div>\n            <h2 className=\"text-2xl font-bold\">No Class Running</h2>\n            <p>Waiting for the teacher to go live...</p>\n          </div>\n        )}\n      </div>\n\n      {/* AI Chatbot Overlay */}\n      <ChatWidget />\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAPA;;;;;;;;;AAmBe,SAAS;IACtB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAmB;IAC7D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC,wBAAwB,uCAAuC;IAE1G,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,QAAQ,gKAAO,CAAC,GAAG,CAAC;IAE1B,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,OAAO;YACV,OAAO,IAAI,CAAC;YACZ;QACF;QAEA,IAAI;YACF,MAAM,UAAwB,IAAA,mKAAS,EAAC;YACxC,iCAAiC;YACjC,aAAa,QAAQ,GAAG,IAAI;QAC9B,EAAE,OAAO,GAAG;YACV,QAAQ,KAAK,CAAC,sBAAsB;QACtC;QAEA;IACF,GAAG,EAAE;IAEL,MAAM,iBAAiB;QACrB,IAAI;YACF,MAAM,MAAM,MAAM,gJAAK,CAAC,GAAG,CACzB,6DAAmC,cAAc,CAAC,EAClD;gBAAE,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;gBAAC;YAAE;YAElD,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,GAAG;gBACvB,aAAa,IAAI,IAAI,CAAC,EAAE;YAC1B;QACF,EAAE,OAAO,OAAY;YACnB,IAAI,MAAM,QAAQ,IAAI,MAAM,QAAQ,CAAC,MAAM,KAAK,KAAK;gBACnD,gBAAgB;YAClB;QACF,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAI,SAAS,qBAAO,8OAAC;QAAI,WAAU;kBAA2E;;;;;;IAE9G,qBACE,8OAAC;QAAI,WAAU;;0BAGb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCACV,0BACC;;8CACE,8OAAC;oCAAK,WAAU;;;;;;gCAAuD;gCAChE,UAAU,KAAK;;2CAEtB;;;;;;kCAEP,8OAAC;wBAAO,SAAS,IAAM,OAAO,IAAI,CAAC;wBAAe,WAAU;kCAAmE;;;;;;;;;;;;0BAMjI,8OAAC;gBAAI,WAAU;0BAEZ,eACC,mBAAmB;8BACnB,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;0CAAgB;;;;;;0CAC/B,8OAAC;gCAAG,WAAU;0CAA0B;;;;;;0CACxC,8OAAC;gCAAE,WAAU;0CAAqB;;;;;;0CAClC,8OAAC;gCACC,SAAS,IAAM,OAAO,IAAI,CAAC;gCAC3B,WAAU;0CACX;;;;;;;;;;;;;;;;2BAKH,YACF,mBAAmB;8BACnB,8OAAC,qLAAY;oBACX,QAAO;oBACP,UAAU,UAAU,WAAW;oBAC/B,iBAAiB;wBACf,qBAAqB;wBACrB,2BAA2B;wBAC3B,oBAAoB;oBACtB;oBACA,0BAA0B;wBACxB,iBAAiB;4BACf;4BAAc;4BAAU;4BAAkB;4BAAW;4BACrD;4BAAqB;4BAAU;4BAAW;4BAAQ;4BAClD;4BAAiB;4BAAY;4BAAe;4BAAY;4BACxD;4BAAgB;4BAAa;4BAAY;4BAAS;4BAClD;4BAAY;4BAAuB;4BAAY;4BAAQ;yBACxD;oBACH;oBACA,2BAA2B;oBAC3B,UAAU;wBACR,aAAa,UAAU,KAAK,CAAC,IAAI,CAAC,EAAE;wBACpC,OAAO,UAAU,+CAA+C;oBAClE;oBACA,cAAc,CAAC;wBACb,UAAU,KAAK,CAAC,MAAM,GAAG;oBAC3B;;;;;yCAGF,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;sCAAgB;;;;;;sCAC/B,8OAAC;4BAAG,WAAU;sCAAqB;;;;;;sCACnC,8OAAC;sCAAE;;;;;;;;;;;;;;;;;0BAMT,8OAAC,2IAAU;;;;;;;;;;;AAGjB"}}]
}